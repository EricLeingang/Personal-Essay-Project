Age = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\Age.csv",head=TRUE,sep=","))
Agreeableness = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\Agreeableness.csv",head=TRUE,sep=","))
Conscientiousness = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\Conscientiousness.csv",head=TRUE,sep=","))
EnvFocus = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\EnvFocus.csv",head=TRUE,sep=","))
Ethnicity = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\Ethnicity.csv",head=TRUE,sep=","))
Extraversion = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\Extraversion.csv",head=TRUE,sep=","))
Gender = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\Gender.csv",head=TRUE,sep=","))
GPA = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\GPA.csv",head=TRUE,sep=","))
IntExtRating = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\IntExtRating.csv",head=TRUE,sep=","))
LOTR = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\LOTR.csv",head=TRUE,sep=","))
VFIEnhancement = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\VFIEnhancement.csv",head=TRUE,sep=","))
VFISocial = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\VFISocial.csv",head=TRUE,sep=","))
VFICareer = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\VFICareer.csv",head=TRUE,sep=","))
VFIProtective = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\VFIProtective.csv",head=TRUE,sep=","))
VFIUnderstanding = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\VFIUnderstanding.csv",head=TRUE,sep=","))
VFIValues = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\VFIValues.csv",head=TRUE,sep=","))
Major = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\Major.csv",head=TRUE,sep=","))
Neurotocism = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\Neurotocism.csv",head=TRUE,sep=","))
NextPage = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\NextPage.csv",head=TRUE,sep=","))
Openness = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\Openness.csv",head=TRUE,sep=","))
OPFocus = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\OPFocus.csv",head=TRUE,sep=","))
OverallRating = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\OverallRating.csv",head=TRUE,sep=","))
OverallFuture = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\OverallFuture.csv",head=TRUE,sep=","))
OverallDaily = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\OverallDaily.csv",head=TRUE,sep=","))
ProAttRating = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\ProAttRating.csv",head=TRUE,sep=","))
ProEnvironment = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\ProEnvironment.csv",head=TRUE,sep=","))
ProsocialPersonality = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\ProsocialPersonality.csv",head=TRUE,sep=","))
RF = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\RF.csv",head=TRUE,sep=","))
SelfEfficacy = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\SelfEfficacy.csv",head=TRUE,sep=","))
VFI = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\VFI.csv",head=TRUE,sep=","))
VolunteerLikert = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\VolunteerLikert.csv",head=TRUE,sep=","))
WordCount = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\WordCount.csv",head=TRUE,sep=","))
WritingRating = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\WritingRating.csv",head=TRUE,sep=","))
WritingFuture = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\WritingFuture.csv",head=TRUE,sep=","))
WritingDaily = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\WritingDaily.csv",head=TRUE,sep=","))
YearsCollege = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\YearsCollege.csv",head=TRUE,sep=","))
PastPositive = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\PastPositive.csv",head=TRUE,sep=","))
PastNegative = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\PastNegative.csv",head=TRUE,sep=","))
FuturePerspective = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\FuturePerspective.csv",head=TRUE,sep=","))
PresentFatalistic = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\PresentFatalistic.csv",head=TRUE,sep=","))
PresentHedonistic = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\PresentHedonistic.csv",head=TRUE,sep=","))
VolPY = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\VolPY.csv",head=TRUE,sep=","))
VolCurrent = as.matrix(read.csv(file="C:\\Users\\Eric Leingang\\Desktop\\Final Paper\\Variable Data\\VolCurrent.csv",head=TRUE,sep=","))

# WR1 = subset(WritingRating, select = -c(WritQ2,WritQ3,WritQ4))
# WR2 = subset(WritingRating, select = -c(WritQ1,WritQ3,WritQ4))
# WR3 = subset(WritingRating, select = -c(WritQ1,WritQ2,WritQ4))
# WR4 = subset(WritingRating, select = -c(WritQ1,WritQ2,WritQ3))
# OR1 = subset(OverallRating, select = -c(Overall2,Overall3,Overall4))
# OR2 = subset(OverallRating, select = -c(Overall1,Overall3,Overall4))
# OR3 = subset(OverallRating, select = -c(Overall1,Overall2,Overall4))
# OR4 = subset(OverallRating, select = -c(Overall1,Overall2,Overall3))
# PA1 = subset(ProAttRating, select = -c(ProAtt2,ProAtt3,ProAtt4))
# PA2 = subset(ProAttRating, select = -c(ProAtt1,ProAtt3,ProAtt4))
# PA3 = subset(ProAttRating, select = -c(ProAtt1,ProAtt2,ProAtt4))
# PA4 = subset(ProAttRating, select = -c(ProAtt1,ProAtt2,ProAtt3))
# OP1 = subset(OPFocus, select = -c(FOP2,FOP3,FOP4))
# OP2 = subset(OPFocus, select = -c(FOP1,FOP3,FOP4))
# OP3 = subset(OPFocus, select = -c(FOP1,FOP2,FOP4))
# OP4 = subset(OPFocus, select = -c(FOP1,FOP2,FOP3))
# EF1 = subset(EnvFocus, select = -c(EF2,EF3,EF4))
# EF2 = subset(EnvFocus, select = -c(EF1,EF3,EF4))
# EF3 = subset(EnvFocus, select = -c(EF1,EF2,EF4))
# EF4 = subset(EnvFocus, select = -c(EF1,EF2,EF3))
# IE1 = subset(IntExtRating, select = -c(IntExt2,IntExt3,IntExt4))
# IE2 = subset(IntExtRating, select = -c(IntExt1,IntExt3,IntExt4))
# IE3 = subset(IntExtRating, select = -c(IntExt1,IntExt2,IntExt4))
# IE4 = subset(IntExtRating, select = -c(IntExt1,IntExt2,IntExt3))
# 
# summary(OR1)
# summary(OR2)
# summary(OR3)
# summary(OR4)
# 
# WR12 = subset(WritingRating, select = -c(WritQ3,WritQ4))
# WR23 = subset(WritingRating, select = -c(WritQ1,WritQ4))
# WR34 = subset(WritingRating, select = -c(WritQ1,WritQ2))
# WR14 = subset(WritingRating, select = -c(WritQ2,WritQ3))
# OR12 = subset(OverallRating, select = -c(Overall3,Overall4))
# OR23 = subset(OverallRating, select = -c(Overall1,Overall4))
# OR34 = subset(OverallRating, select = -c(Overall1,Overall2))
# OR14 = subset(OverallRating, select = -c(Overall2,Overall3))
# PA12 = subset(ProAttRating, select = -c(ProAtt3,ProAtt4))
# PA23 = subset(ProAttRating, select = -c(ProAtt1,ProAtt4))
# PA34 = subset(ProAttRating, select = -c(ProAtt1,ProAtt2))
# PA14 = subset(ProAttRating, select = -c(ProAtt2,ProAtt3))
# OP12 = subset(OPFocus, select = -c(FOP3,FOP4))
# OP23 = subset(OPFocus, select = -c(FOP1,FOP4))
# OP34 = subset(OPFocus, select = -c(FOP1,FOP2))
# OP14 = subset(OPFocus, select = -c(FOP2,FOP3))
# EF12 = subset(EnvFocus, select = -c(EF3,EF4))
# EF23 = subset(EnvFocus, select = -c(EF1,EF4))
# EF34 = subset(EnvFocus, select = -c(EF1,EF2))
# EF14 = subset(EnvFocus, select = -c(EF2,EF3))
# IE12 = subset(IntExtRating, select = -c(IntExt3,IntExt4))
# IE23 = subset(IntExtRating, select = -c(IntExt1,IntExt4))
# IE34 = subset(IntExtRating, select = -c(IntExt1,IntExt2))
# IE14 = subset(IntExtRating, select = -c(IntExt2,IntExt3))
# 
# library(irr)
# library(psych)
# 
# icc(OverallRating,"twoway","consistency")
# icc(OR12,"twoway","consistency")
# icc(OR23,"twoway","consistency")
# icc(OR34,"twoway","consistency")
# icc(OR14,"twoway","consistency")
# kappam.fleiss(IntExtRating)
# kappam.fleiss(IE12)
# kappam.fleiss(IE23)
# kappam.fleiss(IE34)
# kappam.fleiss(IE14)
# icc(WritingRating,"twoway","consistency")
# icc(WR12,"twoway","consistency")
# icc(WR23,"twoway","consistency")
# icc(WR34,"twoway","consistency")
# icc(WR14,"twoway","consistency")
# icc(ProAttRating,"twoway","consistency")
# icc(PA12,"twoway","consistency")
# icc(PA23,"twoway","consistency")
# icc(PA34,"twoway","consistency")
# icc(PA14,"twoway","consistency")
# icc(OPFocus,"twoway","consistency")
# icc(OP12,"twoway","consistency")
# icc(OP23,"twoway","consistency")
# icc(OP34,"twoway","consistency")
# icc(OP14,"twoway","consistency")
# icc(EnvFocus,"twoway","consistency")
# icc(EF12,"twoway","consistency")
# icc(EF23,"twoway","consistency")
# icc(EF34,"twoway","consistency")
# icc(EF14,"twoway","consistency")

OpenT = as.matrix(rowMeans(Openness, na.rm = TRUE, dims = 1))
ConscT = as.matrix(rowMeans(Conscientiousness, na.rm = TRUE, dims = 1))
ExtraT = as.matrix(rowMeans(Extraversion, na.rm = TRUE, dims = 1))
AgreeT = as.matrix(rowMeans(Agreeableness, na.rm = TRUE, dims = 1))
NeuroT = as.matrix(rowMeans(Neurotocism, na.rm = TRUE, dims = 1), "Neuroticism")

WritT = as.matrix(rowMeans(WritingRating, na.rm = TRUE, dims = 1))
WritFT = as.matrix(rowMeans(WritingFuture, na.rm = TRUE, dims = 1))
WritDT = as.matrix(rowMeans(WritingDaily, na.rm = TRUE, dims = 1))
OverT = as.matrix(rowMeans(OverallRating, na.rm = TRUE, dims = 1))
OverFT = as.matrix(rowMeans(OverallFuture, na.rm = TRUE, dims = 1))
OverDT = as.matrix(rowMeans(OverallDaily, na.rm = TRUE, dims = 1))
ProAT = as.matrix(rowMeans(ProAttRating, na.rm = TRUE, dims = 1))
EnvFT = as.matrix(rowMeans(EnvFocus, na.rm = TRUE, dims = 1))
OPFT = as.matrix(rowMeans(OPFocus, na.rm = TRUE, dims = 1))
IERT = as.matrix(rowMeans(IntExtRating, na.rm = TRUE, dims = 1))

LOTRT = as.matrix(rowMeans(LOTR, na.rm = TRUE, dims = 1))
VFIST = as.matrix(rowMeans(VFISocial, na.rm = TRUE, dims = 1))
VFIET = as.matrix(rowMeans(VFIEnhancement, na.rm = TRUE, dims = 1))
VFIVT = as.matrix(rowMeans(VFIValues, na.rm = TRUE, dims = 1))
VFIUT = as.matrix(rowMeans(VFIUnderstanding, na.rm = TRUE, dims = 1))
VFICT = as.matrix(rowMeans(VFICareer, na.rm = TRUE, dims = 1))
VFIPT = as.matrix(rowMeans(VFIProtective, na.rm = TRUE, dims = 1))
ProET = as.matrix(rowMeans(ProEnvironment, na.rm = TRUE, dims = 1))
ProSocT = as.matrix(rowMeans(ProsocialPersonality, na.rm = TRUE, dims = 1))
RFT = as.matrix(rowMeans(RF, na.rm = TRUE, dims = 1))
SelfEffT = as.matrix(rowMeans(SelfEfficacy, na.rm = TRUE, dims = 1))
VFIT = as.matrix(rowMeans(VFI, na.rm = TRUE, dims = 1))
VolLikT = as.matrix(rowMeans(VolunteerLikert, na.rm = TRUE, dims = 1))

PPT = as.matrix(rowMeans(PastPositive, na.rm = TRUE, dims = 1))
PNT = as.matrix(rowMeans(PastNegative, na.rm = TRUE, dims = 1))
FPT = as.matrix(rowMeans(FuturePerspective, na.rm = TRUE, dims = 1))
PFT = as.matrix(rowMeans(PresentFatalistic, na.rm = TRUE, dims = 1))
PHT = as.matrix(rowMeans(PresentHedonistic, na.rm = TRUE, dims = 1))

summary(PPT)
summary(PNT)
summary(FPT)
summary(PFT)
summary(PHT)

summary(LOTRT)
summary(ProET)
summary(ProSocT)
summary(RFT)
summary(SelfEffT)
summary(VFIT)
summary(VolLikT)

summary(WritT)
summary(WritFT)
summary(WritDT)
summary(OverT)
summary(OverFT)
summary(OverDT)
summary(ProAT)
summary(EnvFT)
summary(OPFT)

summary(OpenT)
summary(ConscT)
summary(ExtraT)
summary(AgreeT)
summary(NeuroT)

summary(Age)
summary(GPA)
summary(YearsCollege)
summary(WordCount)

Matrix = cbind(GPA,Age,YearsCollege,NeuroT,AgreeT,ExtraT,ConscT,OpenT,WordCount,NextPage,IERT,
               WritT,WritFT,WritDT,OverT,OverFT,OverDT,ProAT,EnvFT,OPFT,LOTRT,ProET,ProSocT,RFT,
               SelfEffT,VolPY,VolCurrent,VFIT,VFIET,VFIVT,VFICT,
               VFIST,VFIUT,VFIPT,VolLikT,PPT,PNT,FPT,PHT,PFT)
Matrix2 = cor(Matrix,use='pairwise')
rownames(Matrix2) <- list("GPA","Age","YearsinCollege","Neurotocism","Agreeableness","Extraversion",
                          "Conscientiousness","Openness","WordCount","NextPage","InternalizationRating",
                          "EssayWritingQuality","FutureWritingQuality","DailyWritingQuality",
                          "OverallEssayQuality","FutureOverallQuality","DailyOverallQuality",
                          "ProsocialAttitudesEssay","ProenvironmentalAttitudesEssay","FocusOnOtherPeopleEssay",
                          "LOTR","ProenvironmentalAttitudes","ProsocialAttitudes",
                          "RFT","SelfEfficacy","VolunteerPastYear","VolunteerCurrent",
                          "VFI","VFIEnhancement","VFIValues","VFICareer","VFISocial",
                          "VFIUnderstanding","VFIProtective","VolunteerLikert","PastPositive",
                          "PastNegative","FutureOrientation","PresentHedonistic","PresentFatalistic")
colnames(Matrix2) <- list("GPA","Age","YearsinCollege","Neurotocism","Agreeableness","Extraversion",
                          "Conscientiousness","Openness","WordCount","NextPage","InternalizationRating",
                          "EssayWritingQuality","FutureWritingQuality","DailyWritingQuality",
                          "OverallEssayQuality","FutureOverallQuality","DailyOverallQuality",
                          "ProsocialAttitudesEssay","ProenvironmentalAttitudesEssay","FocusOnOtherPeopleEssay",
                          "LOTR","ProenvironmentalAttitudes","ProsocialAttitudes",
                          "RFT","SelfEfficacy","VolunteerPastYear","VolunteerCurrent",
                          "VFI","VFIEnhancement","VFIValues","VFICareer","VFISocial",
                          "VFIUnderstanding","VFIProtective","VolunteerLikert","PastPositive",
                          "PastNegative","FutureOrientation","PresentHedonistic","PresentFatalistic")
colnames(Matrix) <- list("GPA","Age","YearsinCollege","Neurotocism","Agreeableness","Extraversion",
                         "Conscientiousness","Openness","WordCount","NextPage","InternalizationRating",
                         "EssayWritingQuality","FutureWritingQuality","DailyWritingQuality",
                         "OverallEssayQuality","FutureOverallQuality","DailyOverallQuality",
                         "ProsocialAttitudesEssay","ProenvironmentalAttitudesEssay","FocusOnOtherPeopleEssay",
                         "LOTR","ProenvironmentalAttitudes","ProsocialAttitudes",
                         "RFT","SelfEfficacy","VolunteerPastYear","VolunteerCurrent",
                         "VFI","VFIEnhancement","VFIValues","VFICareer","VFISocial",
                         "VFIUnderstanding","VFIProtective","VolunteerLikert","PastPositive",
                         "PastNegative","FutureOrientation","PresentHedonistic","PresentFatalistic")
Matrix3=data.frame(Matrix2)
write.csv(Matrix3, "CorrelationMatrix.csv")

Matrix4a = na.omit(cbind(GPA,Age,YearsCollege,NeuroT,AgreeT,ExtraT,ConscT,OpenT,WordCount,NextPage,
              WritT,OverT,LOTRT,ProET,ProSocT,RFT,
              SelfEffT,VolPY,VolCurrent,VFIET,VFIVT,VFICT,
              VFIST,VFIUT,VFIPT,VolLikT,PPT,PNT,FPT,PHT,PFT))
factornames.T = c("GPA","Age","YearsinCollege","Neurotocism","Agreeableness","Extraversion",
                   "Conscientiousness","Openness","WordCount","NextPage",
                   "EssayWritingQuality",
                   "OverallEssayQuality",
                   "LOTR","ProenvironmentalAttitudes","ProsocialAttitudes",
                   "RFT","SelfEfficacy","VolunteerPastYear","VolunteerCurrent","VFIEnhancement","VFIValues","VFICareer","VFISocial",
                   "VFIUnderstanding","VFIProtective","VolunteerLikert","PastPositive",
                   "PastNegative","FutureOrientation","PresentHedonistic","PresentFatalistic")
Matrix4b = cor(Matrix4a)
Matrix4 = matrix(Matrix4b,nrow=31,ncol=31,dimnames = list(factornames.T,factornames.T))


PC.DATA = princomp(Matrix4,cor=TRUE)
summary(PC.DATA)
plot(PC.DATA)


library(nFactors)
ev4 <- eigen(Matrix4) # get eigenvalues
ap4 <- parallel(subject=nrow(Matrix4),var=ncol(Matrix4),
               rep=100,cent=.05)
nS4 <- nScree(x=ev4$values, aparallel=ap4$eigen$qevpea)
plotnScree(nS4)

Matrix5a = na.omit(cbind(GPA,Age,YearsCollege,NeuroT,AgreeT,ExtraT,ConscT,OpenT,WordCount,NextPage,IERT,
                        WritFT,OverFT,ProAT,EnvFT,OPFT,LOTRT,ProET,ProSocT,RFT,
                        SelfEffT,VolPY,VolCurrent,VFIET,VFIVT,VFICT,
                        VFIST,VFIUT,VFIPT,VolLikT,PPT,PNT,FPT,PHT,PFT))
factornames.F = c("GPA","Age","YearsinCollege","Neurotocism","Agreeableness","Extraversion",
                 "Conscientiousness","Openness","WordCount","NextPage","InternalizationRating",
                 "FutureWritingQuality",
                 "FutureOverallQuality",
                 "ProsocialAttitudesEssay","ProenvironmentalAttitudesEssay","FocusOnOtherPeopleEssay",
                 "LOTR","ProenvironmentalAttitudes","ProsocialAttitudes",
                 "RFT","SelfEfficacy","VolunteerPastYear","VolunteerCurrent",
                 "VFIEnhancement","VFIValues","VFICareer","VFISocial",
                 "VFIUnderstanding","VFIProtective","VolunteerLikert","PastPositive",
                 "PastNegative","FutureOrientation","PresentHedonistic","PresentFatalistic")
Matrix5b = cor(Matrix5a)
Matrix5 = matrix(Matrix5b,nrow=35,ncol=35,dimnames = list(factornames.F,factornames.F))

PC.DATA = princomp(Matrix5,cor=TRUE)
summary(PC.DATA)
plot(PC.DATA)

ev5 <- eigen(Matrix5) # get eigenvalues
ap5 <- parallel(subject=nrow(Matrix5),var=ncol(Matrix5),
               rep=100,cent=.05)
nS5 <- nScree(x=ev5$values, aparallel=ap5$eigen$qevpea)
plotnScree(nS5)

Matrix6a = na.omit(cbind(GPA,Age,YearsCollege,NeuroT,AgreeT,ExtraT,ConscT,OpenT,WordCount,NextPage,
                         WritDT,OverDT,LOTRT,ProET,ProSocT,RFT,
                         SelfEffT,VolPY,VolCurrent,VFIET,VFIVT,VFICT,
                         VFIST,VFIUT,VFIPT,VolLikT,PPT,PNT,FPT,PHT,PFT))
factornames.D = c("GPA","Age","YearsinCollege","Neurotocism","Agreeableness","Extraversion",
                  "Conscientiousness","Openness","WordCount","NextPage",
                  "DailyWritingQuality",
                  "DailyOverallQuality",
                  "LOTR","ProenvironmentalAttitudes","ProsocialAttitudes",
                  "RFT","SelfEfficacy","VolunteerPastYear","VolunteerCurrent",
                  "VFIEnhancement","VFIValues","VFICareer","VFISocial",
                  "VFIUnderstanding","VFIProtective","VolunteerLikert","PastPositive",
                  "PastNegative","FutureOrientation","PresentHedonistic","PresentFatalistic")
Matrix6b = cor(Matrix6a)
Matrix6 = matrix(Matrix6b,nrow=31,ncol=31,dimnames = list(factornames.D,factornames.D))

PC.DATA = princomp(Matrix6,cor=TRUE)
summary(PC.DATA)
plot(PC.DATA)

ev6 <- eigen(Matrix6) # get eigenvalues
ap6 <- parallel(subject=nrow(Matrix6),var=ncol(Matrix6),
                rep=100,cent=.06)
nS6 <- nScree(x=ev6$values, aparallel=ap6$eigen$qevpea)
plotnScree(nS6)

sink("factor analyses.txt")
"Varimax and Oblimin for All Tests,Varimax and Oblimin for Future Only,Varimax and Oblimin for Daily Only"
fa(r = Matrix4, nfactors = 5, rotate = "varimax", SMC = FALSE, 
   fm = "ml",)
fa(r = Matrix4, nfactors = 5, rotate = "oblimin", SMC = FALSE, 
   fm = "ml",)
fa(r = Matrix5, nfactors = 5, rotate = "varimax", SMC = FALSE, 
   fm = "ml",)
fa(r = Matrix5, nfactors = 5, rotate = "oblimin", SMC = FALSE, 
   fm = "ml",)
fa(r = Matrix6, nfactors = 5, rotate = "varimax", SMC = FALSE, 
   fm = "ml",)
fa(r = Matrix6, nfactors = 5, rotate = "oblimin", SMC = FALSE, 
   fm = "ml",)
sink()

sink("Interactions.txt")
"Main Effects and Interactions"
anova(lm(WritFT ~ SelfEffT*VFIVT))
anova(lm(ProAT ~ ExtraT*VFIVT))
anova(lm(ProET ~ FPT*VFIVT*ConscT))
anova(lm(GPA ~ PHT*ExtraT*ConscT))
sink()
